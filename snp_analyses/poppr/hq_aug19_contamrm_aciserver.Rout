
R version 3.5.2 (2018-12-20) -- "Eggshell Igloo"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> 
> # aug 8 2019. this script has been updated to use vcf with coral contam removed (this removed only a 2409 snps). need to rerun everything
> 
> setwd("/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")
> 
> # install packages
> #install.packages("poppr",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("dendextend",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("ape",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("dplyr",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("adegenet",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("ade4",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("crayon",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("ggplot2",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("cowplot",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> #install.packages("withr",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
> install.packages("labeling",lib="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/", repos="https://CRAN.R-project.org/")
trying URL 'https://CRAN.R-project.org/src/contrib/labeling_0.3.tar.gz'
Content type 'application/x-gzip' length 10722 bytes (10 KB)
==================================================
downloaded 10 KB

* installing *source* package 'labeling' ...
** package 'labeling' successfully unpacked and MD5 sums checked
** R
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
  converting help for package 'labeling'
    finding HTML links ... done
    extended                                html  
    extended.figures                        html  
    gnuplot                                 html  
    heckbert                                html  
    labeling-internal                       html  
    labeling-package                        html  
    matplotlib                              html  
    nelder                                  html  
    rpretty                                 html  
    sparks                                  html  
    thayer                                  html  
    wilkinson                               html  
** building package indices
** testing if installed package can be loaded
* DONE (labeling)

The downloaded source packages are in
	'/tmp/RtmpJhSAIN/downloaded_packages'
> 
> # load them
> library("withr", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")
> library("crayon", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")
> library("ggplot2", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")

Attaching package: 'ggplot2'

The following object is masked from 'package:crayon':

    %+%

> library("ade4", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")
> library("adegenet", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")

   /// adegenet 2.1.1 is loaded ////////////

   > overview: '?adegenet'
   > tutorials/doc/questions: 'adegenetWeb()' 
   > bug reports/feature requests: adegenetIssues()



Attaching package: 'adegenet'

The following object is masked from 'package:crayon':

    chr

> library("dendextend", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")

---------------------
Welcome to dendextend version 1.9.0
Type citation('dendextend') for how to cite the package.

Type browseVignettes(package = 'dendextend') for the package vignette.
The github page is: https://github.com/talgalili/dendextend/

Suggestions and bug-reports can be submitted at: https://github.com/talgalili/dendextend/issues
Or contact: <tal.galili@gmail.com>

	To suppress this message use:  suppressPackageStartupMessages(library(dendextend))
---------------------


Attaching package: 'dendextend'

The following object is masked from 'package:stats':

    cutree

> library("ape", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")

Attaching package: 'ape'

The following objects are masked from 'package:dendextend':

    ladderize, rotate

> library("dplyr", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")

Attaching package: 'dplyr'

The following object is masked from 'package:ggplot2':

    vars

The following objects are masked from 'package:stats':

    filter, lag

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union

> library("poppr", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")
This is poppr version 2.8.1. To get started, type package?poppr
OMP parallel support: available
> library("cowplot", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")

Attaching package: 'cowplot'

The following object is masked from 'package:ggplot2':

    ggsave

> library("labeling", lib.loc="/storage/home/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/R/")
> 
> dat <- read.table("/storage/home/h/hgr5/ibb3_group/default/genome_resources/Symbiodinium/S.fitti/newsamples_092018/mm80_nov18/contam_removal_08082019/transposed_nocontam_aug12.txt", check.names = FALSE, header = T, row.names = 1)
> 
> my <- df2genind(dat, ploidy = 1, sep = "")
Warning in df2genind(dat, ploidy = 1, sep = "") :
  The observed allele dosage (1-14653) does not match the defined ploidy (1-1).
Please check that your input parameters (ncode, sep) are correct.
Warning message:
In df2genind(dat, ploidy = 1, sep = "") :
  character '.' detected in names of loci; replacing with '_'
> obj2 <- as.genclone(my)
> 
> cols <- c("skyblue2","#C38D9E", '#E8A87C',"darkcyan","#e27d60") # colors used on the poster
> 
> set.seed(999)
> theTree <- obj2 %>%
+   aboot(dist = provesti.dist, sample = 100, tree = "nj",
+         cutoff = 50, quiet = TRUE) %>%
+   ladderize() # organize branches by clade
> plot.phylo(theTree, label.offset = 0.0125,cex=0.7,
+            font=2, lwd=6)
> add.scale.bar(length = 0.1, cex=.65) # add a scale bar showing 5% difference.
> nodelabels(theTree$node.label, cex=.6, adj = c(1.5, -0.1), frame = "n", font=3,
+            xpd = TRUE)
> 
> # write the newick output
> write.tree(theTree, file = "TREE_aug19_nocontam", digits = 20, tree.names = FALSE)
> 
> #### 1% threshold
> xdis<-provesti.dist(obj2)
> mlg.filter(obj2, distance= xdis) <- 0.01 #threshold 0.01 copied from SAK
> m <- mlg.table(obj2, background=TRUE, color=TRUE)
Warning message:
In library(package, lib.loc = lib.loc, character.only = TRUE, logical.return = TRUE,  :
  there is no package called 'bindrcpp'
> # save the plot
> #ggsave(m, "thresh01.png")
> #save_plot("thres01.png", m, base_aspect_ratio = 1.5)
> 
> 
> #### 5% threshold
> xdis<-provesti.dist(obj2)
> mlg.filter(obj2, distance= xdis) <- 0.05 #threshold 0.05 experiment
> n <- mlg.table(obj2, background=TRUE, color=TRUE)
> #save_plot("thres05.png", n, base_aspect_ratio = 1.5)
> 
> #### 10% threshold
> xdis<-provesti.dist(obj2)
> mlg.filter(obj2, distance= xdis) <- 0.1 #threshold 0.1 experiment
> o <- mlg.table(obj2, background=TRUE, color=TRUE)
> #save_plot("thres1.png", o, base_aspect_ratio = 1.5)
> 
> ind <- mlg.id(obj2)
> #ind
> 
> ### 1% threshold
> mlg.crosspop(obj2)
Error in mlg.crosspop(obj2) : 
  Multiple populations are needed for this analysis.
Execution halted
